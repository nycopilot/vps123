#!/usr/bin/env bash

# ===================================================

#  PTERODACTYL HOSTING MANAGER - NEXT GEN ULTRA EDITION

#                     2025 Edition

# ===================================================

#  Original Creator: MahimOp

#  YouTube : https://www.youtube.com/@mahimxyz

#  Discord : https://discord.gg/zkDNdPpArS

# ===================================================

set -e

# Next-Gen Neon Color Theme

RESET="\e[0m"

BOLD="\e[1m"

DIM="\e[2m"

UNDERLINE="\e[4m"

CYAN="\e[96m"

BLUE="\e[94m"

PURPLE="\e[95m"

GREEN="\e[92m"

YELLOW="\e[93m"

RED="\e[91m"

WHITE="\e[97m"

NEON_GREEN="\e[38;5;82m"

NEON_PURPLE="\e[38;5;165m"

NEON_BLUE="\e[38;5;75m"

GLOW="\e[38;5;51m"

DANGER="\e[38;5;196m"

clear

# Epic Welcome Animation Header

welcome_banner() {

    clear

    echo -e "${NEON_BLUE}"

    cat << "EOF"

 ___      ___       __       __    __   __     ___      ___ 
|"  \    /"  |     /""\     /" |  | "\ |" \   |"  \    /"  |
 \   \  //   |    /    \   (:  (__)  :)||  |   \   \  //   |
 /\\  \/.    |   /' /\  \   \/      \/ |:  |   /\\  \/.    |
|: \.        |  //  __'  \  //  __  \\ |.  |  |: \.        |
|.  \    /:  | /   /  \\  \(:  (  )  :)/\  |\ |.  \    /:  |
|___|\__/|___|(___/    \___)\__|  |__/(__\_|_)|___|\__/|___|
                                                            

EOF

    echo -e "${NEON_PURPLE}${BOLD}                NEXT GEN ULTRA EDITION - 2025${RESET}"

    echo -e "${GLOW}              Ultimate Pterodactyl Control Center${RESET}"

    echo -e "${DIM}      Original Creator: ${BOLD}MahimOp${RESET} ${DIM}| YouTube: @mahimxyz${RESET}"

    echo -e "${DIM}      Discord: https://discord.gg/zkDNdPpArS${RESET}"

    echo -e "${NEON_BLUE}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${RESET}\n"

    sleep 1.5

}

# Utility Functions

progress() { echo -e "${NEON_GREEN}${BOLD}âž¤ $1${RESET}"; }

success() { echo -e "${GREEN}${BOLD}âœ“ $1${RESET}"; }

warning() { echo -e "${YELLOW}${BOLD}! $1${RESET}"; }

error() { echo -e "${RED}${BOLD}âœ˜ $1${RESET}"; }

print_box_header() {

    local text="$1"

    local color="${2:-$NEON_PURPLE}"

    echo -e "${color}${BOLD}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${RESET}"

    echo -e "${color}${BOLD}â•‘${RESET} ${WHITE}${BOLD}$text$(printf '%*s' $((58 - ${#text})) '') ${color}${BOLD}â•‘${RESET}"

    echo -e "${color}${BOLD}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${RESET}\n"

}

print_menu_option() {

    local num="$1"

    local text="$2"

    echo -e "${NEON_BLUE}   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”${RESET}"

    echo -e "${NEON_BLUE}   â”‚${RESET} ${WHITE}${BOLD}[${NEON_GREEN}${num}${WHITE}]${RESET} ${CYAN}${text}$(printf '%*s' $((48 - ${#text} - 3)) '') ${NEON_BLUE}â”‚${RESET}"

    echo -e "${NEON_BLUE}   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜${RESET}"

}

# Remote Script Runner

run_remote_script() {

    local url="$1"

    local name="$2"

    clear

    echo -e "${NEON_PURPLE}"

    cat << "EOF"

 ___      ___       __       __    __   __     ___      ___ 
|"  \    /"  |     /""\     /" |  | "\ |" \   |"  \    /"  |
 \   \  //   |    /    \   (:  (__)  :)||  |   \   \  //   |
 /\\  \/.    |   /' /\  \   \/      \/ |:  |   /\\  \/.    |
|: \.        |  //  __'  \  //  __  \\ |.  |  |: \.        |
|.  \    /:  | /   /  \\  \(:  (  )  :)/\  |\ |.  \    /:  |
|___|\__/|___|(___/    \___)\__|  |__/(__\_|_)|___|\__/|___|
                                                                                                

EOF

    print_box_header "$name" $NEON_PURPLE

    progress "Downloading and executing remote script..."

    local temp_script=$(mktemp)

    if curl -fsSL "$url" -o "$temp_script"; then

        chmod +x "$temp_script"

        bash "$temp_script"

        rm -f "$temp_script"

        success "$name completed!"

    else

        error "Failed to download script from $url"

    fi

    echo -e "\n${NEON_BLUE}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${RESET}"

    read -p $'\e[93mPress Enter to return to menu...\e[0m' -r

}

# Main Menu

show_menu() {

    clear

    echo -e "${NEON_BLUE}"

    cat << "EOF"

 ___      ___       __       __    __   __     ___      ___ 
|"  \    /"  |     /""\     /" |  | "\ |" \   |"  \    /"  |
 \   \  //   |    /    \   (:  (__)  :)||  |   \   \  //   |
 /\\  \/.    |   /' /\  \   \/      \/ |:  |   /\\  \/.    |
|: \.        |  //  __'  \  //  __  \\ |.  |  |: \.        |
|.  \    /:  | /   /  \\  \(:  (  )  :)/\  |\ |.  \    /:  |
|___|\__/|___|(___/    \___)\__|  |__/(__\_|_)|___|\__/|___|
                                                            
                                               

EOF

    echo -e "${NEON_PURPLE}${BOLD}                PTERODACTYL HOSTING MANAGER${RESET}\n"

    print_box_header "CONTROL PANEL" $NEON_PURPLE

    print_menu_option "1"  "Panel Installation"

    print_menu_option "2"  "Wings Installation"

    print_menu_option "3"  "Panel Update"

    print_menu_option "4"  "Uninstall Tools"

    print_menu_option "5"  "Blueprint Setup"

    print_menu_option "6"  "Cloudflare Setup"

    print_menu_option "7"  "Change Theme"

    print_menu_option "8"  "Tailscale (Install + Up)"

    print_menu_option "9"  "Minecraft Player Manager"

    print_menu_option "10" "Jexactyl Installation"

    print_menu_option "0"  "Exit Manager"

    echo -e "\n${NEON_BLUE}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${RESET}"

    read -p $'\e[93m\e[1m   Select option [0-10]: \e[0m' choice

    echo

}

# Welcome

welcome_banner

# Main Loop

while true; do

    show_menu

    case $choice in

        1)  run_remote_script "https://raw.githubusercontent.com/mahimxyzz/Vps/refs/heads/main/cd/panel2.sh" "PANEL INSTALLATION" ;;

        2)  run_remote_script "https://raw.githubusercontent.com/mahimxyzz/Vps/refs/heads/main/cd/wing2.sh" "WINGS INSTALLATION" ;;

        3)  run_remote_script "https://raw.githubusercontent.com/mahimxyzz/Vps/refs/heads/main/cd/update2.sh" "PANEL UPDATE" ;;

        4)  run_remote_script "https://raw.githubusercontent.com/mahimxyzz/Vps/refs/heads/main/cd/uninstall2.sh" "UNINSTALL TOOLS" ;;

        5)  run_remote_script "https://raw.githubusercontent.com/mahimxyzz/Vps/refs/heads/main/cd/Blueprint2.sh" "BLUEPRINT SETUP" ;;

        6)  run_remote_script "https://raw.githubusercontent.com/mahimxyzz/Vps/refs/heads/main/cd/cloudflare.sh" "CLOUDFLARE SETUP" ;;

        7)  run_remote_script "https://raw.githubusercontent.com/mahimxyzz/Vps/refs/heads/main/cd/th2.sh" "THEME CHANGER" ;;

        8)

            clear

            print_box_header "TAILSCALE INSTALLATION" $NEON_PURPLE

            progress "Installing Tailscale..."

            curl -fsSL https://tailscale.com/install.sh | sh

            success "Tailscale installed!"

            systemctl enable --now tailscaled 2>/dev/null || true

            progress "Bringing Tailscale online..."

            if [ -n "$TS_AUTH_KEY" ]; then

                sudo tailscale up --auth-key="$TS_AUTH_KEY" && success "Authenticated via key"

            else

                sudo tailscale up && success "Connected! Approve in admin console"

            fi

            read -p $'\e[93mPress Enter to continue...\e[0m' -r

            ;;

        9)

            clear

            print_box_header "MINECRAFT PLAYER MANAGER" $NEON_PURPLE

            progress "Installing Minecraft extensions..."

            cd /var/www/pterodactyl || { error "Panel directory not found!"; read -p "Press Enter..."; continue; }

            wget -q https://github.com/mahimxyzz/Vps/raw/refs/heads/main/minecraftplayermanager.blueprint

            wget -q https://github.com/mahimxyzz/Vps/raw/refs/heads/main/mcplugins.blueprint

            wget -q https://github.com/mahimxyzz/Vps/raw/refs/heads/main/huxregister.blueprint

            blueprint -i mcplugins.blueprint && success "MC Plugins installed"

            blueprint -i minecraftplayermanager.blueprint && success "Player Manager installed"

            blueprint -i huxregister.blueprint && success "huxregister installed"

            read -p $'\e[93mPress Enter to continue...\e[0m' -r

            ;;

        10)

            clear

            print_box_header "JEXACTYL INSTALLATION" $NEON_PURPLE

            progress "Installing Jexactyl Theme..."

            cd /var/www/pterodactyl || { error "Panel directory not found!"; read -p "Press Enter..."; continue; }

            

            # Remove old theme if exists

            rm -rf resources/scripts/jexactyl

            

            # Clone Jexactyl

            git clone https://github.com/jexactyl/jexactyl.git temp_jexactyl >/dev/null 2>&1

            cp -r temp_jexactyl/resources/scripts/* resources/scripts/

            rm -rf temp_jexactyl

            

            # Apply CSS/JS overrides

            curl -sLo resources/scripts/jexactyl/jexactyl.css https://raw.githubusercontent.com/jexactyl/jexactyl/main/jexactyl.css

            curl -sLo resources/scripts/jexactyl/jexactyl.js https://raw.githubusercontent.com/jexactyl/jexactyl/main/jexactyl.js

            

            # Clear cache

            php artisan view:clear

            php artisan config:clear

            php artisan cache:clear

            

            success "Jexactyl theme installed successfully!"

            echo -e "\n${YELLOW}Refresh your panel with Ctrl+Shift+R to see the new theme!${RESET}"

            read -p $'\e[93mPress Enter to continue...\e[0m' -r

            ;;

        0)

            clear

            echo -e "${DANGER}"

            cat << "EOF"

 ___      ___       __       __    __   __     ___      ___ 
|"  \    /"  |     /""\     /" |  | "\ |" \   |"  \    /"  |
 \   \  //   |    /    \   (:  (__)  :)||  |   \   \  //   |
 /\\  \/.    |   /' /\  \   \/      \/ |:  |   /\\  \/.    |
|: \.        |  //  __'  \  //  __  \\ |.  |  |: \.        |
|.  \    /:  | /   /  \\  \(:  (  )  :)/\  |\ |.  \    /:  |
|___|\__/|___|(___/    \___)\__|  |__/(__\_|_)|___|\__/|___|
                                                            


EOF

            print_box_header "GOODBYE" $DANGER

            echo -e "\n${WHITE}${BOLD}   Thank you for using the Hosting Manager!${RESET}"

            echo -e "${YELLOW}${BOLD}         Powered by MahimOp${RESET}\n"

            echo -e "${NEON_GREEN}${BOLD}Original Creator: MahimOp${RESET}"

            echo -e "${DIM}YouTube: https://www.youtube.com/@mahimxyz${RESET}"

            echo -e "${DIM}Discord: https://discord.gg/zkDNdPpArS${RESET}\n"

            echo -e "${GLOW}${BOLD}See you next time, Operator! ðŸ¦…âœ¨${RESET}\n"

            exit 0

            ;;

        *)  

            error "Invalid option! Choose 0â€“10"

            sleep 2

            ;;

    esac

done
